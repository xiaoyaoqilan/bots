grid_system:
  # ============================================================================
  # 基础配置
  # ============================================================================
  exchange: "lighter"
  symbol: "PUMP"
  grid_type: "follow_long"         # 网格类型：follow_long(价格移动) | long(固定范围) | martingale_long(马丁)
  
  # ============================================================================
  # 价格移动网格参数（grid_type = "follow_long"）
  # ============================================================================
  follow_grid_count: 500          # 网格数量（350格×$0.003=$1.05，避免下限为负）
  follow_timeout: 1000000000000    # 脱离超时（秒）
  follow_distance: 2               # 脱离距离（格）
  price_offset_grids: 10          # 价格偏移（格，让当前价格处于网格内部）
  
  # ============================================================================
  # 固定范围网格参数（grid_type = "long" | "martingale_long"）
  # ============================================================================
  # 启用固定范围网格时，取消下面注释，并注释掉上面的follow参数
  # price_range:
  #   lower_price: 90000.0         # 网格下限
  #   upper_price: 110000.0        # 网格上限
  
  # ============================================================================
  # 通用网格参数
  # ============================================================================
  grid_interval: 0.000005                # 每格间隔
  order_amount: 2546             # 每格基础数量
  quantity_precision: 0            # 数量精度（小数位）
  price_decimals: 6                # 价格精度（小数位）
  
  # ⚠️ 重要：由于 Lighter SDK Bug，以下参数仅作参考，需在网页端手动设置
  margin_mode: "cross"             # 保证金模式：cross(全仓) | isolated(逐仓) 【请在网页端设置】
  leverage: 20                      # 杠杆倍数（1-20倍）【请在网页端设置】
  # 详见：docs/fixes/lighter_margin_mode_sdk_bug.md
  
  martingale_increment: 5.101     # 马丁递增（仅martingale模式生效）
  
  # ============================================================================
  # 🔥 剥头皮模式（持仓过大时自动减仓）
  # ============================================================================
  # 工作原理：
  #   - 监控当前持仓在网格中的位置（百分比）
  #   - 达到触发阈值时，立即市价平仓至目标位置
  #   - 示例：50%触发阈值，10格止盈 → 跌到第250格触发，平仓到第240格
  # 适用场景：
  #   - 单边行情：价格持续下跌，持仓不断增加
  #   - 风险控制：防止持仓过大导致爆仓
  #   - 智能模式：允许多次深度探底，避免过早触发
  # ============================================================================
  scalping_enabled: true           # 是否启用
  scalping_trigger_percent: 55     # 触发阈值（%，从顶部往下）
  scalping_take_profit_grids: 10   # 止盈网格数
  
  smart_scalping_enabled: true     # 智能剥头皮（允许多次深度探底）
  allowed_deep_drops: 1            # 允许深度下跌次数
  min_drop_threshold_percent: 15   # 最小下跌阈值（%）
  
  # ============================================================================
  # 🛡️ 本金保护模式（价格大跌时紧急止损）
  # ============================================================================
  # 工作原理：
  #   - 价格跌破触发阈值时，立即市价平仓所有持仓
  #   - 取消所有网格订单，保护本金
  # 适用场景：
  #   - 瀑布行情：价格快速下跌
  #   - 黑天鹅事件：突发利空消息
  # ============================================================================
  capital_protection_enabled: false  # 是否启用
  capital_protection_trigger_percent: 30  # 触发阈值（%，从顶部往下）
  
  # ============================================================================
  # 💰 止盈模式（盈利达标时锁定利润）
  # ============================================================================
  # 工作原理：
  #   - 监控累计盈利占本金的百分比
  #   - 达到目标盈利时，市价平仓并停止网格
  # 适用场景：
  #   - 达到盈利目标，落袋为安
  #   - 担心行情反转，保护已有利润
  # ============================================================================
  take_profit_enabled: false       # 是否启用
  take_profit_percentage: 0.005    # 止盈阈值（0.005=0.5%）
  
  # ============================================================================
  # 🔒 价格锁定模式（价格突破阈值时暂停交易）
  # ============================================================================
  # 工作原理：
  #   - 价格向盈利方向脱离网格且达到阈值时，冻结网格
  #   - 不平仓，保留订单和持仓，等待价格回落
  #   - 价格回到网格范围内时，自动解除冻结
  # 适用场景：
  #   - 看好后市：价格突破后还可能继续上涨
  #   - 避免过早止盈：等待更高的价格
  # ============================================================================
  price_lock_enabled: false        # 是否启用
  price_lock_threshold: 120000.0   # 锁定阈值（价格>=阈值时锁定）
  price_lock_start_at_threshold: false  # 启动时使用阈值作为起点（仅FOLLOW模式）
  
  # ============================================================================
  # 🛑 止损保护模式（亏损方向脱离时自动处理）
  # ============================================================================
  # 工作原理：
  #   - 价格向亏损方向脱离网格且持续N秒时触发
  #   - 判断实时APR（过去10分钟）：
  #     * APR >= 阈值 → 市价平仓 + 重置网格（继续交易）
  #     * APR < 阈值 → 市价平仓 + 停止程序（退出）
  # 适用场景：
  #   - 单边行情：价格持续向不利方向移动
  #   - 智能决策：根据盈利情况决定是重新开始还是止损退出
  # ============================================================================
  stop_loss_protection_enabled: false  # 是否启用
  stop_loss_trigger_percent: 95.0  # 触发百分比（%，从网格顶部往不利方向）
  stop_loss_escape_timeout: 600    # 脱离超时（秒）
  stop_loss_apr_threshold: 40.0    # APR阈值（%）
  
  # ============================================================================
  # 🧹 退出清理模式（Ctrl+C 时自动平仓和取消订单）
  # ============================================================================
  exit_cleanup_enabled: true       # 是否启用（推荐启用）
  
  # ============================================================================
  # 其他配置
  # ============================================================================
  reverse_order_grid_distance: 2   # 反手挂单距离（格，1-5）
  order_health_check_enabled: true  # 订单健康检查
  order_health_check_interval: 300  # 健康检查间隔（秒）
  health_check_snapshot_count: 2   # 健康检查快照次数（2-5）
  rest_position_query_interval: 120  # REST持仓查询间隔（秒）
  enable_notifications: false      # 通知开关
  fee_rate: 0.00002                # 手续费率（0.002%）

