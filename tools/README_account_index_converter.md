# 🔄 Account Index 进制转换工具

## 简介

Lighter API 的 `account_index` 在不同场景可能使用不同进制：
- **API 文档**: 通常使用十进制（如：`0`, `1`, `123`）
- **前端界面**: 可能显示十六进制（如：`0x0`, `0x1`, `0x7b`）
- **区块链浏览器**: 通常使用十六进制

此工具帮助您快速转换这些格式。

---

## 🚀 快速开始

### 交互式模式（推荐）
```bash
python tools/convert_account_index.py
```

然后输入要转换的值即可。

### 命令行模式

**单个转换**：
```bash
python tools/convert_account_index.py 123456
```

**批量转换**：
```bash
python tools/convert_account_index.py 0 1 123 0x1e240
```

---

## 📋 使用示例

### 示例 1: 十进制 → 十六进制
```bash
$ python tools/convert_account_index.py 123456

======================================================================
🔄 Lighter Account Index 进制转换工具
======================================================================

📥 输入 (十进制):   123456

📤 输出 (十六进制): 0x1e240

✅ 转换完成！
======================================================================
```

### 示例 2: 十六进制 → 十进制
```bash
$ python tools/convert_account_index.py 0x1e240

======================================================================
🔄 Lighter Account Index 进制转换工具
======================================================================

📥 输入 (十六进制): 0x1e240

📤 输出 (十进制):   123456

✅ 转换完成！
======================================================================
```

### 示例 3: 十六进制（不带0x） → 十进制
```bash
$ python tools/convert_account_index.py 1e240

======================================================================
🔄 Lighter Account Index 进制转换工具
======================================================================

📥 输入 (十六进制): 0x1e240

📤 输出 (十进制):   123456

✅ 转换完成！
======================================================================
```

### 示例 4: 批量转换
```bash
$ python tools/convert_account_index.py 0 1 123 0x7b

======================================================================
🔄 Lighter Account Index 进制转换工具 (批量模式)
======================================================================

【1/4】
======================================================================
🔄 Lighter Account Index 进制转换工具
======================================================================

📥 输入 (十进制):   0

📤 输出 (十六进制): 0x0

✅ 转换完成！
======================================================================

【2/4】
...
```

### 示例 5: 交互式模式
```bash
$ python tools/convert_account_index.py

======================================================================
🔄 Lighter Account Index 进制转换工具 (交互模式)
======================================================================

💡 使用说明：
   - 输入十进制数字（如：123456）
   - 输入十六进制数字（如：0x1e240 或 1e240）
   - 输入 'q' 或 'quit' 退出
======================================================================

请输入 account_index: 123

======================================================================
🔄 Lighter Account Index 进制转换工具
======================================================================

📥 输入 (十进制):   123

📤 输出 (十六进制): 0x7b

✅ 转换完成！
======================================================================

请输入 account_index: 0x7b

======================================================================
🔄 Lighter Account Index 进制转换工具
======================================================================

📥 输入 (十六进制): 0x7b

📤 输出 (十进制):   123

✅ 转换完成！
======================================================================

请输入 account_index: q

👋 再见！
```

---

## 🎯 实际应用场景

### 场景 1: Lighter 前端显示的是十六进制
```
前端显示: Account Index = 0x7b

需要转换为十进制用于 API：
$ python tools/convert_account_index.py 0x7b
输出: 123

在配置文件中使用:
account_index: 123  # 十进制
```

### 场景 2: API 文档使用十进制，想验证区块链数据
```
API 文档: account_index = 123

转换为十六进制查询区块链浏览器：
$ python tools/convert_account_index.py 123
输出: 0x7b

在区块链浏览器中搜索: 0x7b
```

### 场景 3: 批量转换配置文件中的值
```bash
# 转换多个账户索引
$ python tools/convert_account_index.py 0 1 2 10 100

# 快速获取对应关系
0   → 0x0
1   → 0x1
2   → 0x2
10  → 0xa
100 → 0x64
```

---

## 📚 支持的格式

| 输入格式 | 示例 | 输出格式 |
|---------|------|---------|
| 十进制 | `123456` | 十六进制 `0x1e240` |
| 十六进制（带0x） | `0x1e240` | 十进制 `123456` |
| 十六进制（不带0x） | `1e240` | 十进制 `123456` |
| 十六进制（大写） | `0X1E240` | 十进制 `123456` |
| 负数（十进制） | `-123` | 十六进制 `-0x7b` |

---

## 🔧 高级用法

### 1. 直接在脚本中使用
```bash
# 快速转换并复制结果
python tools/convert_account_index.py 123 | grep "输出"
```

### 2. 集成到配置脚本
```python
import subprocess

def convert_account_index(value):
    result = subprocess.run(
        ['python', 'tools/convert_account_index.py', str(value)],
        capture_output=True,
        text=True
    )
    # 解析输出...
    return parsed_value
```

### 3. 查看所有示例
```bash
python tools/convert_account_index.py --examples
```

### 4. 查看帮助
```bash
python tools/convert_account_index.py --help
```

---

## ⚠️ 注意事项

### 1. Lighter API 使用十进制
```yaml
# ✅ 正确：lighter_config.yaml
account_index: 0  # 十进制
api_key_index: 0  # 十进制
```

```yaml
# ❌ 错误：不要在配置文件中使用十六进制
account_index: 0x0  # 会导致 YAML 解析错误
```

### 2. 前端显示可能是十六进制
- Lighter 前端界面可能显示 `0x0`, `0x1` 等
- 需要转换为十进制后填入配置文件

### 3. 区块链浏览器使用十六进制
- 在区块链浏览器中查询时，需要使用十六进制格式
- 例如：`https://explorer.lighter.xyz/account/0x7b`

---

## 🛠️ 故障排除

### 问题 1: "无法识别的输入格式"
**原因**: 输入的字符串既不是有效的十进制也不是十六进制

**解决**:
- 确保十进制只包含数字：`0-9`
- 确保十六进制只包含：`0-9`, `a-f`, `A-F`

### 问题 2: YAML 解析错误
**原因**: 在 YAML 配置文件中使用了十六进制格式（如 `0x0`）

**解决**:
```yaml
# ❌ 错误
account_index: 0x0

# ✅ 正确
account_index: 0
```

使用此工具转换为十进制：
```bash
$ python tools/convert_account_index.py 0x0
输出: 0
```

---

## 📖 相关文档

- `docs/lighter/LIGHTER_API_KEY_SETUP_GUIDE.md` - API 密钥配置指南
- `docs/lighter/如何获取account_index.md` - 如何获取 account_index
- `tools/query_account_simple.py` - 查询账户索引工具

---

## ✨ 特性总结

- ✅ 自动识别输入格式（十进制/十六进制）
- ✅ 双向转换（十进制 ↔ 十六进制）
- ✅ 支持多种输入格式（带/不带 0x 前缀）
- ✅ 支持批量转换
- ✅ 支持交互式模式
- ✅ 清晰的输出格式
- ✅ 完善的错误处理

---

## 🎉 总结

这个工具帮助您：
1. ✅ 快速转换 `account_index` 的进制
2. ✅ 在不同场景（API、前端、区块链）间切换
3. ✅ 避免配置错误
4. ✅ 提高配置效率

**推荐使用交互式模式**，方便快捷！

```bash
python tools/convert_account_index.py
```

